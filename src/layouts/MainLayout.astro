---
import BaseHead from "@/components/layout/BaseHead.astro";
import { ThemeManager } from "@/components/theme";
import GoogleAnalytics from "@/components/analytics/GoogleAnalytics.astro";
import type { ImageMetadata } from "astro";
import { ClientRouter } from "astro:transitions";

interface Props {
  seoProps: {
    title?: string;
    description?: string;
    type?: "website" | "article" | "product";
    image?: ImageMetadata;
  };
}

const {
  seoProps: { description, title, image, type },
} = Astro.props;
---

<!doctype html>
<html lang="es">
  <head>
    <!-- Google tag (gtag.js) -->
    <GoogleAnalytics />

    <ClientRouter />
    <BaseHead
      title={title}
      description={description}
      type={type}
      image={image}
    />

    <ClientRouter />
    <ThemeManager />
  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-N88Z66CX"
        height="0"
        width="0"
        style="display:none;visibility:hidden"></iframe></noscript
    >
    <!-- End Google Tag Manager (noscript) -->

    <slot />

    <script is:inline>
      const addYear = () => {
        try {
          const currentYear = new Date().getFullYear().toString();
          const yearElement = document.getElementById("year");
          if (yearElement) {
            yearElement.textContent = currentYear;
          } else {
            console.error("Element with id 'year' not found.");
          }
        } catch (error) {
          console.error("Error inserting current year:", error);
        }
      };

      document.addEventListener("astro:page-load", addYear);
      document.addEventListener("astro:after-preparation", addYear);
    </script>
  </body>
</html>
